CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

PROJECT("libFdk-aac")
MESSAGE(STATUS "Configuring libFdk-aac")

SET(FDK_PATH_TO_DM_ROOT ${CMAKE_CURRENT_SOURCE_DIR}/../../../ CACHE INTERNAL "fdk dm root")
SET(CMAKE_MODULE_PATH ${FDK_PATH_TO_DM_ROOT}/dm-cmake)
INCLUDE(SetPlatformDefines)
INCLUDE(MergeStaticLibraries)
SET_PLATFORM_DEFINES()

ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libAACdec)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libAACenc)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libFDK)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libMpegTPDec)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libMpegTPEnc)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libPCMutils)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libSBRdec)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libSBRenc)
ADD_SUBDIRECTORY(${CMAKE_CURRENT_SOURCE_DIR}/libSYS)

LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacAACdec)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacAACenc)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacMpegTPDec)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacMpegTPEnc)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacPCMutils)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacSBRdec)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacSBRenc)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacSYS)
LIST(APPEND DM_LIBFDK_AAC_LIBS_NAMES FdkAacFDK)

SET(DM_LIBFDK_AAC_LIBS ${DM_LIBFDK_AAC_LIBS_NAMES} CACHE INTERNAL "Libraries for ibFdk-aac" )

IF(CMAKE_GENERATOR MATCHES "^Unix Makefiles")
  merge_static_libs(FdkAac ${DM_LIBFDK_AAC_LIBS})
ENDIF(CMAKE_GENERATOR MATCHES "^Unix Makefiles")

IF (APPLE)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libAACdec/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libAACenc/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libFDK/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libMpegTPDec/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libMpegTPEnc/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libPCMutils/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libSBRdec/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libSBRenc/include)
  INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR}/libSYS/include)

  ADD_EXECUTABLE(aac-enc ${CMAKE_CURRENT_SOURCE_DIR}/aac-enc.c wavreader.c)
  TARGET_LINK_LIBRARIES(aac-enc ${DM_LIBFDK_AAC_LIBS})
ENDIF(APPLE)
